# Налаштування Tenancy для Komunalka

## Що було зроблено

### 1. Налаштування Tenancy згідно Filament 4
- ✅ Додано `tenantRegistration()` та `tenantProfile()` в `AdminPanelProvider`
- ✅ Створено `RegisterAddress` page для реєстрації нових адрес
- ✅ Створено `EditAddressProfile` page для редагування адреси
- ✅ Address модель тепер implements `HasName` для відображення в tenancy menu

### 2. Додавання користувачів
- ✅ Створено `AddressUserResource` для управління користувачами адреси
- ✅ Користувачі можуть бути додані тільки власником адреси
- ✅ Підтримка ролей: "Власник" та "Учасник"
- ✅ Можливість редагувати та видаляти користувачів (крім власника)

### 3. Створення адрес
- ✅ Адреси створюються через tenancy registration
- ✅ При створенні адреси, поточний користувач автоматично стає власником
- ✅ AddressResource приховано з навігації (використовується tenancy menu)

### 4. Показники (лічильники) відносно адрес
- ✅ MeterResource має `$isScopedToTenant = true`
- ✅ При створенні лічильника в tenancy контексті, address_id підставляється автоматично
- ✅ Лічильники фільтруються по поточній адресі (tenant)

### 5. Додавання даних показників
- ✅ ReadingsRelationManager дозволяє додавати показання до лічильника
- ✅ Валідація: нове значення не може бути меншим за попереднє
- ✅ Валідація: дата має бути унікальною для кожного лічильника
- ✅ Можливість завантажувати фото показань
- ✅ Автоматичний розрахунок різниці між показаннями
- ✅ Створено окремий `MeterReadingResource` для перегляду всіх показань по адресі

## Структура навігації

Після авторизації користувач бачить:
1. **Tenancy Menu** - вибір адреси (або створення нової)
2. Після вибору адреси:
   - **Лічильники** - список лічильників адреси
   - **Користувачі** - управління доступом до адреси
   - **Показання** - перегляд всіх показань по адресі

## Як використовувати

### Створення нової адреси
1. Після авторизації натисніть на кнопку створення tenant (вгорі)
2. Заповніть форму з деталями адреси
3. Ви автоматично станете власником адреси

### Додавання користувачів
1. Виберіть адресу в tenancy menu
2. Перейдіть до розділу "Користувачі"
3. Натисніть "Додати користувача"
4. Виберіть користувача та призначте роль

### Створення лічильника
1. Виберіть адресу в tenancy menu
2. Перейдіть до розділу "Лічильники"
3. Натисніть "Створити"
4. Заповніть форму (адреса підставиться автоматично)

### Додавання показань
Варіант 1 (через лічильник):
1. Виберіть лічильник зі списку
2. Перейдіть на вкладку "Показання"
3. Натисніть "Додати показання"

Варіант 2 (через загальний список):
1. Перейдіть до розділу "Показання"
2. Перегляньте всі показання по поточній адресі
3. Можна фільтрувати по лічильнику

## Безпека та доступ

- Користувачі бачать тільки ті адреси, де вони є власником або учасником
- Тільки власник адреси може додавати/видаляти користувачів
- Всі лічильники та показання прив'язані до адреси (tenant)
- Редагувати та видаляти можна тільки останнє показання
